<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products | Nebhan Tires</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="js/products.js"></script>
    <script src="js/products-page.js"></script>
    <script src="js/categories.js"></script>
    <script src="js/app.js"></script>
    <style>
        [x-cloak] { display: none !important; }
        .scrollbar-thin::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 20px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">
<!-- Top Bar -->
<div class="bg-black text-white text-sm py-2">
    <div class="container mx-auto px-4 flex justify-between items-center">
        <div class="flex items-center space-x-4">
            <span><i class="fas fa-phone-alt mr-1"></i> +961 70 608 543</span>
            <span class="hidden md:inline"><i class="fas fa-envelope mr-1"></i> info@nebhantires.com</span>
        </div>
        <div class="flex items-center space-x-4">
            <a href="#" class="hover:text-red-300 transition"><i class="fas fa-truck mr-1"></i> Order Tracking</a>
            <span>|</span>
            <a href="#" class="hover:text-red-300 transition">Find Us</a>
        </div>
    </div>
</div>

<!-- Header -->
<header class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto flex flex-wrap justify-between items-center py-4 px-4">
        <!-- Logo -->
        <div class="flex items-center space-x-3">
            <a href="index.html" class="flex items-center space-x-3">
                <div class="h-12 w-12 bg-red-600 rounded-full flex items-center justify-center text-white text-xl font-bold">N</div>
                <span class="font-extrabold text-2xl text-red-600 tracking-wide">NEBHAN TIRES</span>
            </a>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 lg:flex justify-center hidden lg:block" x-data="{ isOpen: false }">
            <div class="flex space-x-1">
                <a href="index.html" class="py-3 px-4 hover:bg-gray-700 text-gray-800 hover:text-white rounded transition flex items-center">
                    <i class="fas fa-home mr-2"></i> Home
                </a>
                <div class="group relative">
                    <a href="products.html" class="py-3 px-4 bg-red-600 hover:bg-red-700 transition flex items-center rounded text-white">
                        <i class="fas fa-tire mr-2"></i> Tires & Wheels <i class="fas fa-chevron-down ml-1 text-xs"></i>
                    </a>
                    <div class="absolute left-0 top-full w-48 bg-white shadow-lg hidden group-hover:block z-10">
                        <a href="products.html?category=passenger-tires" class="block px-4 py-2 text-gray-800 hover:bg-red-50">Passenger Tires</a>
                        <a href="products.html?category=truck-tires" class="block px-4 py-2 text-gray-800 hover:bg-red-50">Truck Tires</a>
                        <a href="products.html?category=suv-tires" class="block px-4 py-2 text-gray-800 hover:bg-red-50">SUV Tires</a>
                        <a href="products.html?category=performance-tires" class="block px-4 py-2 text-gray-800 hover:bg-red-50">Performance Tires</a>
                        <a href="products.html?category=alloy-wheels" class="block px-4 py-2 text-gray-800 hover:bg-red-50">Alloy Wheels</a>
                    </div>
                </div>

            </div>
        </nav>

        <!-- Action Buttons -->
        <div class="flex items-center space-x-5">
            <a href="#" class="text-gray-700 hover:text-red-600 transition relative">
                <i class="fas fa-heart text-xl"></i>
                <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
            </a>
            <a href="#" class="text-gray-700 hover:text-red-600 transition relative">
                <i class="fas fa-user text-xl"></i>
            </a>
            <a href="cart.html" class="bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition font-semibold flex items-center">
                <i class="fas fa-shopping-cart mr-2"></i>
                Cart (<span x-text="$store.cart.getTotalItems()">0</span>)
            </a>
            <!-- Mobile menu button -->
            <div class="lg:hidden flex items-center">
                <button @click="isOpen = !isOpen" class="text-red-600 p-3 focus:outline-none">
                    <i class="fas" :class="isOpen ? 'fa-times' : 'fa-bars'"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation Menu -->
    <nav class="bg-gray-800 text-white lg:hidden" x-data="{ isOpen: false }">
        <div x-show="isOpen" x-cloak>
            <a href="index.html" class="block py-3 px-4 hover:bg-gray-700 flex items-center">
                <i class="fas fa-home mr-2"></i> Home
            </a>
            <a href="products.html" class="block py-3 px-4 bg-red-600 hover:bg-red-700 transition flex items-center">
                <i class="fas fa-tire mr-2"></i> Tires & Wheels
            </a>
            <a href="#" class="block py-3 px-4 hover:bg-gray-700 flex items-center">
                <i class="fas fa-car-wash mr-2"></i> Services
            </a>
            <a href="products.html?filter=sale" class="block py-3 px-4 hover:bg-gray-700 flex items-center">
                <i class="fas fa-tag mr-2"></i> Deals
            </a>
            <a href="about.html" class="block py-3 px-4 hover:bg-gray-700 flex items-center">
                <i class="fas fa-info-circle mr-2"></i> About
            </a>
            <a href="contact.html" class="block py-3 px-4 hover:bg-gray-700 flex items-center">
                <i class="fas fa-phone mr-2"></i> Contact
            </a>
            <a href="products.html?filter=new" class="block py-3 px-4 hover:bg-gray-700 text-green-400 flex items-center">
                <i class="fas fa-percentage mr-2"></i> New Arrivals
            </a>
        </div>
    </nav>

    <!-- Optional: New Arrivals link for large screens -->
    <div class="hidden lg:flex justify-end bg-gray-800 px-4 py-2">
        <a href="products.html?filter=new" class="py-3 px-4 hover:bg-gray-700 transition flex items-center text-green-400">
            <i class="fas fa-percentage mr-2"></i> New Arrivals
        </a>
    </div>
</header>

<!-- Breadcrumb -->
<div class="bg-gray-100 py-3">
    <div class="container mx-auto px-4">
        <div class="flex items-center text-sm">
            <a href="index.html" class="text-gray-600 hover:text-red-600 transition">Home</a>
            <span class="mx-2 text-gray-400">/</span>
            <a href="products.html" class="text-gray-600 hover:text-red-600 transition">All Products</a>
            <template x-if="selectedCategorySlug">
                <div class="flex items-center">
                    <span class="mx-2 text-gray-400">/</span>
                    <span class="text-red-600" x-text="getCategoryName(selectedCategory)"></span>
                </div>
            </template>
        </div>
    </div>
</div>

<!-- Page Content -->
<div x-data="productCatalog({ products: PRODUCTS, categories: CATEGORIES, defaultView: 'grid', defaultSort: 'featured' })" class="container mx-auto px-4 py-8">
    <!-- Page Title with Category -->
    <div class="mb-6">
        <h1 class="text-3xl font-bold mb-2" x-text="selectedCategory ? getCategoryName(selectedCategory) : 'All Products'">All Products</h1>
        <p class="text-gray-600">Find the perfect tires and wheels for your vehicle.</p>
    </div>

    <!-- Mobile Filter Button -->
    <div class="block md:hidden mb-4">
        <button @click="mobileFiltersOpen = true" class="w-full bg-red-600 text-white px-4 py-2 rounded-lg flex items-center justify-center">
            <i class="fas fa-filter mr-2"></i> Filter Products
        </button>
    </div>

    <!-- Main Content -->
    <div class="flex flex-col md:flex-row gap-8">
        <!-- Sidebar / Filters -->
        <div class="md:w-1/4">
            <!-- Desktop Filters -->
            <div class="hidden md:block bg-white rounded-lg shadow-md p-6">
                <div class="mb-6">
                    <h3 class="font-bold text-lg mb-3">Categories</h3>
                    <ul class="space-y-2">
                        <li>
                            <a @click.prevent="selectCategoryBySlug(null)" href="#"
                               class="flex items-center text-gray-700 hover:text-red-600 transition"
                               :class="{'text-red-600 font-semibold': selectedCategory === null}">
                                All Products
                            </a>
                        </li>
                        <template x-for="category in categoryData.filter(c => !c.parent_id)" :key="category.id">
                            <li>
                                <a @click.prevent="selectCategoryBySlug(category.slug)" href="#"
                                   class="flex items-center text-gray-700 hover:text-red-600 transition"
                                   :class="{'text-red-600 font-semibold': selectedCategory === category.id}">
                                    <span x-text="category.name"></span>
                                </a>
                                <ul class="ml-4 mt-2 space-y-2">
                                    <template x-for="subCategory in categoryData.filter(c => c.parent_id === category.id)" :key="subCategory.id">
                                        <li>
                                            <a @click.prevent="selectCategoryBySlug(subCategory.slug)" href="#"
                                               class="flex items-center text-gray-700 hover:text-red-600 transition"
                                               :class="{'text-red-600 font-semibold': selectedCategory === subCategory.id}">
                                                <span x-text="subCategory.name"></span>
                                            </a>
                                        </li>
                                    </template>
                                </ul>
                            </li>
                        </template>
                    </ul>
                </div>

                <div class="mb-6">
                    <h3 class="font-bold text-lg mb-3">Price Range</h3>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="0-100" x-model="priceRanges">
                            <span class="ml-2">$0 - $100</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="100-200" x-model="priceRanges">
                            <span class="ml-2">$100 - $200</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="200-300" x-model="priceRanges">
                            <span class="ml-2">$200 - $300</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="200+" x-model="priceRanges">
                            <span class="ml-2">$300+</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <h3 class="font-bold text-lg mb-3">Product Status</h3>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox rounded text-red-600" x-model="showNew">
                            <span class="ml-2">New Arrivals</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox rounded text-red-600" x-model="showSale">
                            <span class="ml-2">On Sale</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox rounded text-red-600" x-model="inStock">
                            <span class="ml-2">In Stock Only</span>
                        </label>
                    </div>
                </div>

                <button @click="clearFilters" class="w-full bg-gray-200 text-gray-800 px-4 py-2 rounded-full hover:bg-gray-300 transition">
                    Clear Filters
                </button>
            </div>

            <!-- Mobile Filters Drawer -->
            <div x-show="mobileFiltersOpen" x-cloak class="fixed inset-0 z-50 overflow-hidden">
                <div class="absolute inset-0 bg-black bg-opacity-50" @click="mobileFiltersOpen = false"></div>
                <div class="absolute inset-y-0 left-0 max-w-full flex">
                    <div class="relative w-full max-w-xs bg-white shadow-xl">
                        <div class="h-full flex flex-col py-6 bg-white shadow-xl">
                            <div class="px-4 flex items-center justify-between">
                                <h2 class="text-lg font-medium text-gray-900">Filters</h2>
                                <button @click="mobileFiltersOpen = false" class="text-gray-500 hover:text-gray-700">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="mt-6 px-4 flex-1 overflow-y-auto scrollbar-thin">
                                <div class="mb-6">
                                    <h3 class="font-bold text-lg mb-3">Categories</h3>
                                    <ul class="space-y-2">
                                        <li>
                                            <a @click.prevent="selectCategoryBySlug(null); mobileFiltersOpen = false" href="#"
                                               class="flex items-center text-gray-700 hover:text-red-600 transition"
                                               :class="{'text-red-600 font-semibold': selectedCategory === null}">
                                                All Products
                                            </a>
                                        </li>
                                        <template x-for="category in categoryData.filter(c => !c.parent_id)" :key="category.id">
                                            <li>
                                                <a @click.prevent="selectCategoryBySlug(category.slug); mobileFiltersOpen = false" href="#"
                                                   class="flex items-center text-gray-700 hover:text-red-600 transition"
                                                   :class="{'text-red-600 font-semibold': selectedCategory === category.id}">
                                                    <span x-text="category.name"></span>
                                                </a>
                                                <ul class="ml-4 mt-2 space-y-2">
                                                    <template x-for="subCategory in categoryData.filter(c => c.parent_id === category.id)" :key="subCategory.id">
                                                        <li>
                                                            <a @click.prevent="selectCategoryBySlug(subCategory.slug); mobileFiltersOpen = false" href="#"
                                                               class="flex items-center text-gray-700 hover:text-red-600 transition"
                                                               :class="{'text-red-600 font-semibold': selectedCategory === subCategory.id}">
                                                                <span x-text="subCategory.name"></span>
                                                            </a>
                                                        </li>
                                                    </template>
                                                </ul>
                                            </li>
                                        </template>
                                    </ul>
                                </div>

                                <div class="mb-6">
                                    <h3 class="font-bold text-lg mb-3">Price Range</h3>
                                    <div class="space-y-2">
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="0-100" x-model="priceRanges">
                                            <span class="ml-2">$0 - $100</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="100-200" x-model="priceRanges">
                                            <span class="ml-2">$100 - $200</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="200-300" x-model="priceRanges">
                                            <span class="ml-2">$200 - $300</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox rounded text-red-600" value="200+" x-model="priceRanges">
                                            <span class="ml-2">$300+</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="mb-6">
                                    <h3 class="font-bold text-lg mb-3">Product Status</h3>
                                    <div class="space-y-2">
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox rounded text-red-600" x-model="showNew">
                                            <span class="ml-2">New Arrivals</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox rounded text-red-600" x-model="showSale">
                                            <span class="ml-2">On Sale</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox rounded text-red-600" x-model="inStock">
                                            <span class="ml-2">In Stock Only</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="border-t border-gray-200 px-4 py-4 space-y-2">
                                <button @click="mobileFiltersOpen = false" class="w-full bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition">
                                    Apply Filters
                                </button>
                                <button @click="clearFilters(); mobileFiltersOpen = false" class="w-full bg-gray-200 text-gray-800 px-4 py-2 rounded-full hover:bg-gray-300 transition">
                                    Clear All
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Product Listing -->
        <div class="md:w-3/4">
            <!-- Search and Sort -->
            <div class="bg-white rounded-lg shadow-md p-4 mb-6">
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                    <div class="w-full sm:w-auto">
                        <div class="relative">
                            <input type="text" x-model="searchQuery" class="w-full pl-10 pr-4 py-2 border rounded-full focus:ring-2 focus:ring-red-600 focus:border-red-600 focus:outline-none" placeholder="Search products...">
                            <div class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center gap-4 w-full sm:w-auto">
                        <div class="flex-grow sm:flex-grow-0">
                            <select x-model="sortBy" class="w-full border rounded-full px-4 py-2 focus:ring-2 focus:ring-red-600 focus:border-red-600 focus:outline-none">
                                <option value="featured">Featured</option>
                                <option value="name">Name (A-Z)</option>
                                <option value="price-asc">Price (Low to High)</option>
                                <option value="price-desc">Price (High to Low)</option>
                                <option value="newest">Newest</option>
                            </select>
                        </div>
                        <div class="hidden md:flex items-center space-x-2">
                            <button @click="setView('grid')" class="p-2 rounded" :class="view === 'grid' ? 'bg-red-600 text-white' : 'bg-gray-200 text-gray-600'">
                                <i class="fas fa-th"></i>
                            </button>
                            <button @click="setView('list')" class="p-2 rounded" :class="view === 'list' ? 'bg-red-600 text-white' : 'bg-gray-200 text-gray-600'">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Info -->
            <div class="mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center">
                <p class="text-gray-600 mb-3 sm:mb-0">
                    Showing <span x-text="getFilteredProducts().length" class="font-semibold">0</span> products
                </p>
                <div x-show="selectedCategory !== null || priceRanges.length > 0 || showNew || showSale || inStock || searchQuery !== ''" class="flex items-center text-sm">
                    <span class="mr-2">Active filters:</span>
                    <template x-if="selectedCategory !== null">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-red-100 text-red-800 mr-2">
                                <span x-text="getCategoryName(selectedCategory)"></span>
                                <button @click="selectedCategory = null; selectedCategorySlug = null" class="ml-1 text-red-600 hover:text-red-800">
                                    <i class="fas fa-times"></i>
                                </button>
                            </span>
                    </template>
                    <template x-if="priceRanges.length > 0">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-red-100 text-red-800 mr-2">
                                <span>Price</span>
                                <button @click="priceRanges = []" class="ml-1 text-red-600 hover:text-red-800">
                                    <i class="fas fa-times"></i>
                                </button>
                            </span>
                    </template>
                    <template x-if="showNew">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-red-100 text-red-800 mr-2">
                                <span>New</span>
                                <button @click="showNew = false" class="ml-1 text-red-600 hover:text-red-800">
                                    <i class="fas fa-times"></i>
                                </button>
                            </span>
                    </template>
                    <template x-if="showSale">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-red-100 text-red-800 mr-2">
                                <span>Sale</span>
                                <button @click="showSale = false" class="ml-1 text-red-600 hover:text-red-800">
                                    <i class="fas fa-times"></i>
                                </button>
                            </span>
                    </template>
                    <template x-if="inStock">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-red-100 text-red-800 mr-2">
                                <span>In Stock</span>
                                <button @click="inStock = false" class="ml-1 text-red-600 hover:text-red-800">
                                    <i class="fas fa-times"></i>
                                </button>
                            </span>
                    </template>
                    <template x-if="searchQuery !== ''">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-red-100 text-red-800 mr-2">
                                <span x-text="'Search: ' + searchQuery"></span>
                                <button @click="searchQuery = ''" class="ml-1 text-red-600 hover:text-red-800">
                                    <i class="fas fa-times"></i>
                                </button>
                            </span>
                    </template>
                    <button @click="clearFilters" class="text-red-600 hover:underline text-sm font-medium">
                        Clear All
                    </button>
                </div>
            </div>

            <!-- No Results Message -->
            <div x-show="getFilteredProducts().length === 0" class="bg-white rounded-lg shadow-md p-8 text-center">
                <div class="text-gray-400 text-5xl mb-4">
                    <i class="fas fa-search"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-700 mb-2">No products found</h3>
                <p class="text-gray-600 mb-4">Try adjusting your search or filter criteria to find what you're looking for.</p>
                <button @click="clearFilters" class="bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition">
                    Reset Filters
                </button>
            </div>

            <!-- Grid View -->
            <div x-show="view === 'grid' && getFilteredProducts().length > 0" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <template x-for="product in getFilteredProducts()" :key="product.id">
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col h-full group">
                        <div class="relative">
                            <template x-if="product.isOnSale">
                                <span class="absolute top-3 left-3 bg-red-500 text-white text-sm px-2 py-1 rounded-full">Sale</span>
                            </template>
                            <template x-if="product.isNew">
                                <span class="absolute top-3 left-3 bg-gray-800 text-white text-sm px-2 py-1 rounded-full">New</span>
                            </template>
                            <div class="absolute top-3 right-3 flex space-x-2">
                                <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <a :href="'product.html?slug=' + product.slug">
                                <img :src="product.images[0]" :alt="product.name" class="w-full h-48 object-cover group-hover:scale-105 transition duration-300">
                            </a>
                        </div>
                        <div class="p-4 flex flex-col flex-grow">
                            <div class="flex items-center mb-2">
                                <div class="flex text-amber-400">
                                    <template x-for="i in Math.floor(product.rating || 0)">
                                        <i class="fas fa-star"></i>
                                    </template>
                                    <template x-if="product.rating % 1 > 0">
                                        <i class="fas fa-star-half-alt"></i>
                                    </template>
                                    <template x-for="i in (5 - Math.ceil(product.rating || 0))">
                                        <i class="far fa-star"></i>
                                    </template>
                                </div>
                                <span class="text-gray-600 text-sm ml-2" x-text="product.rating + ' (' + product.reviews_count + ')'"></span>
                            </div>
                            <a :href="'product.html?slug=' + product.slug" class="hover:text-red-600 transition">
                                <h3 class="font-bold text-lg" x-text="product.name"></h3>
                            </a>
                            <p class="text-gray-600 text-sm mb-4" x-text="product.description.substring(0, 80) + '...'"></p>
                            <div class="mt-auto">
                                <div class="flex justify-between items-center mb-3">
                                    <div>
                                        <template x-if="product.isOnSale">
                                            <span class="line-through text-gray-400 text-sm" x-text="'$' + product.base_price.toFixed(2)"></span>
                                        </template>
                                        <span class="font-bold text-lg text-red-600" x-text="'$' + (product.salePrice || product.base_price).toFixed(2)"></span>
                                    </div>
                                    <span x-show="product.hasVariants ? product.totalVariantStock > 0 : product.stock > 0" class="text-green-500 text-sm">In Stock</span>
                                    <span x-show="product.hasVariants ? product.totalVariantStock === 0 : product.stock === 0" class="text-red-500 text-sm">Out of Stock</span>
                                </div>
                                <button class="w-full bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition flex items-center justify-center"
                                        @click="$store.cart.addItem(product, 1)"
                                        :disabled="product.hasVariants ? product.totalVariantStock === 0 : product.stock === 0"
                                        :class="{ 'opacity-50 cursor-not-allowed': product.hasVariants ? product.totalVariantStock === 0 : product.stock === 0 }">
                                    <template x-if="product.hasVariants ? product.totalVariantStock > 0 : product.stock > 0">
                                        <span><i class="fas fa-cart-plus mr-2"></i> Add to Cart</span>
                                    </template>
                                    <template x-if="product.hasVariants ? product.totalVariantStock === 0 : product.stock === 0">
                                        <span><i class="fas fa-exclamation-circle mr-2"></i> Out of Stock</span>
                                    </template>
                                </button>
                            </div>

                        </div>
                    </div>
                </template>
            </div>

            <!-- List View -->
            <div x-show="view === 'list' && getFilteredProducts().length > 0" class="space-y-6">
                <template x-for="product in getFilteredProducts()" :key="product.id">
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden group">
                        <div class="flex flex-col md:flex-row">
                            <div class="md:w-1/3 relative">
                                <template x-if="product.isOnSale">
                                    <span class="absolute top-3 left-3 bg-red-500 text-white text-sm px-2 py-1 rounded-full">Sale</span>
                                </template>
                                <template x-if="product.isNew">
                                    <span class="absolute top-3 left-3 bg-gray-800 text-white text-sm px-2 py-1 rounded-full">New</span>
                                </template>
                                <div class="absolute top-3 right-3 flex space-x-2">
                                    <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                                        <i class="far fa-heart"></i>
                                    </button>
                                    <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <a :href="'product.html?slug=' + product.slug">
                                    <img :src="product.images[0]" :alt="product.name" class="w-full h-60 md:h-full object-cover group-hover:scale-105 transition duration-300">
                                </a>
                            </div>
                            <div class="md:w-2/3 p-6">
                                <div class="flex items-center mb-2">
                                    <div class="flex text-amber-400">
                                        <template x-for="i in Math.floor(product.rating || 0)">
                                            <i class="fas fa-star"></i>
                                        </template>
                                        <template x-if="product.rating % 1 > 0">
                                            <i class="fas fa-star-half-alt"></i>
                                        </template>
                                        <template x-for="i in (5 - Math.ceil(product.rating || 0))">
                                            <i class="far fa-star"></i>
                                        </template>
                                    </div>
                                    <span class="text-gray-600 text-sm ml-2" x-text="product.rating + ' (' + product.reviews_count + ')'"></span>
                                </div>
                                <a :href="'product.html?slug=' + product.slug" class="hover:text-red-600 transition">
                                    <h3 class="font-bold text-xl mb-2" x-text="product.name"></h3>
                                </a>
                                <p class="text-gray-600 mb-4" x-text="product.description.substring(0, 150) + '...'"></p>

                                <div class="mb-4">
                                    <div class="flex flex-wrap gap-2">
                                        <template x-if="product.features">
                                            <template x-for="(value, key) in product.features" :key="key">
                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                                        <span x-text="$data.formatFeatureKey(key) + ': ' + value"></span>
                                                    </span>
                                            </template>
                                        </template>
                                    </div>
                                </div>

                                <div class="flex flex-col sm:flex-row sm:items-center justify-between mt-4">
                                    <div class="mb-4 sm:mb-0">
                                        <template x-if="product.isOnSale">
                                            <span class="line-through text-gray-400 text-sm" x-text="'$' + product.base_price.toFixed(2)"></span>
                                        </template>
                                        <span class="font-bold text-2xl text-red-600" x-text="'$' + (product.salePrice || product.base_price).toFixed(2)"></span>
                                        <span x-show="$data.getVariantStock(product) > 0" class="ml-2 text-green-500">In Stock</span>
                                        <span x-show="$data.getVariantStock(product) === 0" class="ml-2 text-red-500">Out of Stock</span>
                                    </div>
                                    <div class="flex space-x-2">
                                        <a :href="'product.html?slug=' + product.slug" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-full hover:bg-gray-300 transition">
                                            View Details
                                        </a>
                                        <button class="bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition flex items-center justify-center"
                                                @click="$store.cart.addItem(product, 1)"
                                                :disabled="$data.getVariantStock(product) === 0"
                                                :class="{ 'opacity-50 cursor-not-allowed': $data.getVariantStock(product) === 0 }">
                                            <template x-if="$data.getVariantStock(product) > 0">
                                                <span><i class="fas fa-cart-plus mr-2"></i> Add to Cart</span>
                                            </template>
                                            <template x-if="$data.getVariantStock(product) === 0">
                                                <span><i class="fas fa-exclamation-circle mr-2"></i> Out of Stock</span>
                                            </template>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>
            </div>

            <!-- Pagination (Placeholder for now) -->
            <div class="mt-8 flex justify-center">
                <nav class="inline-flex rounded-md shadow">
                    <a href="#" class="px-4 py-2 rounded-l-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50">
                        Previous
                    </a>
                    <a href="#" class="px-4 py-2 border-t border-b border-gray-300 bg-red-600 text-white">
                        1
                    </a>
                    <a href="#" class="px-4 py-2 border-t border-b border-gray-300 bg-white text-gray-700 hover:bg-gray-50">
                        2
                    </a>
                    <a href="#" class="px-4 py-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 rounded-r-md">
                        Next
                    </a>
                </nav>
            </div>
        </div>
    </div>
</div>

<!-- Recently Viewed Products -->
<section class="bg-white py-12">
    <div class="container mx-auto px-6">
        <h2 class="text-2xl font-bold mb-8">Recently Viewed Products</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Product 1 -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col h-full group">
                <div class="relative">
                    <span class="absolute top-3 left-3 bg-red-500 text-white text-sm px-2 py-1 rounded-full">-15%</span>
                    <div class="absolute top-3 right-3 flex space-x-2">
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="far fa-heart"></i>
                        </button>
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <img src="https://images.unsplash.com/photo-1555502287-a0748352c471?auto=format&q=80" alt="Premium All-Season Tires" class="w-full h-48 object-cover group-hover:scale-105 transition duration-300">
                </div>
                <div class="p-4 flex flex-col flex-grow">
                    <div class="flex items-center mb-2">
                        <div class="flex text-amber-400">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                        </div>
                        <span class="text-gray-600 text-sm ml-2">4.5 (86)</span>
                    </div>
                    <h3 class="font-bold text-lg">Michelin Premier A/S</h3>
                    <p class="text-gray-600 text-sm mb-4">Premium all-season tires with exceptional wet braking and comfort.</p>
                    <div class="mt-auto">
                        <div class="flex justify-between items-center mb-3">
                            <div>
                                <span class="line-through text-gray-400 text-sm">$189.99</span>
                                <span class="font-bold text-lg text-red-600">$159.99</span>
                            </div>
                            <span class="text-green-500 text-sm">In Stock</span>
                        </div>
                        <button class="w-full bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition flex items-center justify-center">
                            <i class="fas fa-cart-plus mr-2"></i> Add to Cart
                        </button>
                    </div>
                </div>
            </div>

            <!-- Product 2 -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col h-full group">
                <div class="relative">
                    <div class="absolute top-3 right-3 flex space-x-2">
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="far fa-heart"></i>
                        </button>
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <img src="https://images.unsplash.com/photo-1605695612794-ea09c68b6113?auto=format&q=80" alt="All-Terrain Tires" class="w-full h-48 object-cover group-hover:scale-105 transition duration-300">
                </div>
                <div class="p-4 flex flex-col flex-grow">
                    <div class="flex items-center mb-2">
                        <div class="flex text-amber-400">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                        </div>
                        <span class="text-gray-600 text-sm ml-2">4.0 (54)</span>
                    </div>
                    <h3 class="font-bold text-lg">Continental TerrainContact A/T</h3>
                    <p class="text-gray-600 text-sm mb-4">All-terrain tire with excellent traction on and off-road.</p>
                    <div class="mt-auto">
                        <div class="flex justify-between items-center mb-3">
                            <div>
                                <span class="font-bold text-lg text-red-600">$179.99</span>
                            </div>
                            <span class="text-green-500 text-sm">In Stock</span>
                        </div>
                        <button class="w-full bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition flex items-center justify-center">
                            <i class="fas fa-cart-plus mr-2"></i> Add to Cart
                        </button>
                    </div>
                </div>
            </div>

            <!-- Product 3 -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col h-full group">
                <div class="relative">
                    <span class="absolute top-3 left-3 bg-gray-800 text-white text-sm px-2 py-1 rounded-full">New</span>
                    <div class="absolute top-3 right-3 flex space-x-2">
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="far fa-heart"></i>
                        </button>
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <img src="https://images.unsplash.com/photo-1611921561618-13debee11692?auto=format&q=80" alt="Luxury Alloy Wheels" class="w-full h-48 object-cover group-hover:scale-105 transition duration-300">
                </div>
                <div class="p-4 flex flex-col flex-grow">
                    <div class="flex items-center mb-2">
                        <div class="flex text-amber-400">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                        </div>
                        <span class="text-gray-600 text-sm ml-2">4.5 (32)</span>
                    </div>
                    <h3 class="font-bold text-lg">Enkei RPF1 Alloy Wheels</h3>
                    <p class="text-gray-600 text-sm mb-4">Lightweight performance alloy wheels for enhanced handling and style.</p>
                    <div class="mt-auto">
                        <div class="flex justify-between items-center mb-3">
                            <div>
                                <span class="font-bold text-lg text-red-600">$279.99</span>
                            </div>
                            <span class="text-amber-500 text-sm">Low Stock</span>
                        </div>
                        <button class="w-full bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition flex items-center justify-center">
                            <i class="fas fa-cart-plus mr-2"></i> Add to Cart
                        </button>
                    </div>
                </div>
            </div>

            <!-- Product 4 -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col h-full group">
                <div class="relative">
                    <div class="absolute top-3 right-3 flex space-x-2">
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="far fa-heart"></i>
                        </button>
                        <button class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow hover:text-red-500 transition">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <img src="https://images.unsplash.com/photo-1529776164-ae7a0c477f5d?auto=format&q=80" alt="All-Terrain Tires" class="w-full h-48 object-cover group-hover:scale-105 transition duration-300">
                </div>
                <div class="p-4 flex flex-col flex-grow">
                    <div class="flex items-center mb-2">
                        <div class="flex text-amber-400">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                        </div>
                        <span class="text-gray-600 text-sm ml-2">4.0 (54)</span>
                    </div>
                    <h3 class="font-bold text-lg">BF Goodrich All-Terrain T/A KO2</h3>
                    <p class="text-gray-600 text-sm mb-4">Durable all-terrain tires for trucks and SUVs with enhanced traction.</p>
                    <div class="mt-auto">
                        <div class="flex justify-between items-center mb-3">
                            <div>
                                <span class="font-bold text-lg text-red-600">$199.99</span>
                            </div>
                            <span class="text-green-500 text-sm">In Stock</span>
                        </div>
                        <button class="w-full bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition flex items-center justify-center">
                            <i class="fas fa-cart-plus mr-2"></i> Add to Cart
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter -->
<section class="bg-red-600">
    <div class="container mx-auto px-6 py-12">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-3xl font-bold text-white mb-4">Join Our Newsletter</h2>
            <p class="text-red-100 mb-8">Subscribe to get special offers, exclusive discounts, and seasonal promotions.</p>
            <form class="flex flex-col md:flex-row gap-4">
                <input type="email" placeholder="Your email address" class="flex-grow px-4 py-3 rounded-full focus:outline-none">
                <button type="submit" class="bg-gray-900 text-white px-6 py-3 rounded-full hover:bg-gray-800 transition whitespace-nowrap font-semibold">
                    Subscribe Now
                </button>
            </form>
            <p class="text-red-200 text-sm mt-4">We respect your privacy. Unsubscribe at any time.</p>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="bg-gray-900 text-gray-400 pt-12 pb-6">
    <div class="container mx-auto px-6">
        <div class="grid grid-cols-1 md:grid-cols-5 gap-12 mb-12">
            <div class="md:col-span-2">
                <div class="flex items-center space-x-3 mb-6">
                    <div class="h-12 w-12 bg-red-600 rounded-full flex items-center justify-center text-white text-xl font-bold">N</div>
                    <span class="font-extrabold text-2xl text-white tracking-wide">NEBHAN TIRES</span>
                </div>
                <p class="mb-6">
                    Your trusted source for high-quality tires, wheels, and automotive services in Lebanon. With a commitment to customer satisfaction and passion for cars.
                </p>
                <div class="flex space-x-4">
                    <a href="#" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-red-600 transition">
                        <i class="fab fa-facebook-f text-white"></i>
                    </a>
                    <a href="#" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-red-600 transition">
                        <i class="fab fa-twitter text-white"></i>
                    </a>
                    <a href="#" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-red-600 transition">
                        <i class="fab fa-instagram text-white"></i>
                    </a>
                    <a href="#" class="bg-gray-800 w-10 h-10 rounded-full flex items-center justify-center hover:bg-red-600 transition">
                        <i class="fab fa-whatsapp text-white"></i>
                    </a>
                </div>
            </div>
            <div>
                <h3 class="text-white font-bold text-lg mb-6">Shop</h3>
                <ul class="space-y-3">
                    <li><a href="products.html?category=passenger-tires" class="hover:text-white transition">Passenger Tires</a></li>
                    <li><a href="products.html?category=truck-tires" class="hover:text-white transition">Truck Tires</a></li>
                    <li><a href="products.html?category=suv-tires" class="hover:text-white transition">SUV Tires</a></li>
                    <li><a href="products.html?category=performance-tires" class="hover:text-white transition">Performance Tires</a></li>
                    <li><a href="products.html?category=alloy-wheels" class="hover:text-white transition">Alloy Wheels</a></li>
                    <li><a href="products.html?filter=sale" class="hover:text-white transition">Special Offers</a></li>
                </ul>
            </div>
            <div>
                <h3 class="text-white font-bold text-lg mb-6">Services</h3>
                <ul class="space-y-3">
                    <li><a href="services.html?service=tire-change" class="hover:text-white transition">Tire Change</a></li>
                    <li><a href="services.html?service=wheel-alignment" class="hover:text-white transition">Wheel Alignment</a></li>
                    <li><a href="services.html?service=balancing" class="hover:text-white transition">Wheel Balancing</a></li>
                    <li><a href="services.html?service=car-wash" class="hover:text-white transition">Car Washing</a></li>
                    <li><a href="services.html?service=repair" class="hover:text-white transition">Tire Repair</a></li>
                    <li><a href="services.html" class="hover:text-white transition">All Services</a></li>
                </ul>
            </div>
            <div>
                <h3 class="text-white font-bold text-lg mb-6">Contact</h3>
                <ul class="space-y-3">
                    <li class="flex items-start">
                        <i class="fas fa-map-marker-alt mt-1 mr-3 text-red-600"></i>
                        <span>Nebhan Tires, Main Street, Nabatieh-kfrarruman, Lebanon</span>
                    </li>
                    <li class="flex items-center">
                        <i class="fas fa-phone-alt mr-3 text-red-600"></i>
                        <span>+961 70 608 543</span>
                    </li>
                    <li class="flex items-center">
                        <i class="fas fa-envelope mr-3 text-red-600"></i>
                        <span>info@nebhantires.com</span>
                    </li>
                    <li class="flex items-center">
                        <i class="fas fa-clock mr-3 text-red-600"></i>
                        <span>Mon-Sat: 8AM-6PM, Sun: 9AM-2PM</span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="border-t border-gray-800 pt-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p> 2025 Nebhan Tires. All rights reserved.</p>
                <div class="flex space-x-6 mt-4 md:mt-0">
                    <a href="#" class="hover:text-white transition">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition">Terms of Service</a>
                    <a href="#" class="hover:text-white transition">Sitemap</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- WhatsApp Chat Button -->
<div class="fixed bottom-6 right-6 z-50">
    <button
            @click="$store.ui.openWhatsApp('Hello, I would like to inquire about your products.')"
            class="bg-green-500 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg hover:bg-green-600 transition-colors duration-300">
        <i class="fab fa-whatsapp text-2xl"></i>
    </button>
</div>

<!-- Scroll to Top Button -->
<div class="fixed bottom-6 left-6 z-50">
    <button
            @click="$store.ui.scrollToTop()"
            class="bg-gray-700 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg hover:bg-gray-800 transition-colors duration-300">
        <i class="fas fa-arrow-up"></i>
    </button>
</div>

<!-- Cart Notification -->
<div class="fixed top-20 right-6 z-50">
    <div x-show="$store.ui.cartNotificationVisible"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 transform translate-x-8"
         x-transition:enter-end="opacity-100 transform translate-x-0"
         x-transition:leave="transition ease-in duration-300"
         x-transition:leave-start="opacity-100 transform translate-x-0"
         x-transition:leave-end="opacity-0 transform translate-x-8"
         class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded shadow-md flex items-center"
         x-cloak>
        <i class="fas fa-check-circle text-green-500 mr-3 text-xl"></i>
        <div>
            <div class="font-bold">Item added to cart!</div>
            <a href="cart.html" class="text-sm underline">View your cart</a>
        </div>
    </div>
</div>
</body>
</html>
